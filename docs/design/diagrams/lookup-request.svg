<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 580 478" font-family="monospace" font-size="13">
  <!-- Background -->
  <rect width="580" height="478" fill="#1a1a2e" rx="4"/>

  <!-- Title -->
  <text x="310" y="26" fill="#e0e0e0" text-anchor="middle" font-size="14" font-weight="bold">LookupRequest (0x30) — 303 + 16n bytes</text>

  <!-- Row 0 (0–3): msg_type + request_id starts -->
  <text x="50" y="62" fill="#666" font-size="10" text-anchor="end">0–3</text>

  <rect x="55" y="36" width="130" height="52" fill="#2d4a7a" stroke="#4a90d9" stroke-width="1.5" rx="3"/>
  <text x="120" y="60" fill="#e0e0e0" text-anchor="middle" font-size="12" font-weight="bold">msg_type</text>
  <text x="120" y="78" fill="#8ab4f8" text-anchor="middle" font-size="10">0x30</text>

  <rect x="185" y="36" width="390" height="52" fill="#5a3d2d" stroke="#d9904a" stroke-width="1.5" rx="3"/>
  <text x="380" y="66" fill="#e0e0e0" text-anchor="middle" font-size="12" font-weight="bold">request_id</text>

  <!-- Row 1 (4–8): request_id continued -->
  <text x="50" y="114" fill="#666" font-size="10" text-anchor="end">4–8</text>

  <rect x="55" y="88" width="520" height="52" fill="#5a3d2d" stroke="#d9904a" stroke-width="1.5" rx="3"/>
  <text x="315" y="118" fill="#f8c88a" text-anchor="middle" font-size="10">8 bytes LE — unique random identifier</text>

  <!-- Row 2 (9–24): target -->
  <text x="50" y="166" fill="#666" font-size="10" text-anchor="end">9–24</text>

  <rect x="55" y="140" width="520" height="52" fill="#2d5a5a" stroke="#4ad9d9" stroke-width="1.5" rx="3"/>
  <text x="315" y="162" fill="#e0e0e0" text-anchor="middle" font-size="12" font-weight="bold">target</text>
  <text x="315" y="180" fill="#8af8f8" text-anchor="middle" font-size="10">16 bytes — NodeAddr being sought</text>

  <!-- Row 3 (25–40): origin -->
  <text x="50" y="218" fill="#666" font-size="10" text-anchor="end">25–40</text>

  <rect x="55" y="192" width="520" height="52" fill="#4a2d5a" stroke="#b04ad9" stroke-width="1.5" rx="3"/>
  <text x="315" y="214" fill="#e0e0e0" text-anchor="middle" font-size="12" font-weight="bold">origin</text>
  <text x="315" y="232" fill="#d8a0f8" text-anchor="middle" font-size="10">16 bytes — requester's NodeAddr</text>

  <!-- Row 4 (41–43): ttl + min_mtu -->
  <text x="50" y="270" fill="#666" font-size="10" text-anchor="end">41–43</text>

  <rect x="55" y="244" width="130" height="52" fill="#2d5a4a" stroke="#4ad99a" stroke-width="1.5" rx="3"/>
  <text x="120" y="268" fill="#e0e0e0" text-anchor="middle" font-size="12" font-weight="bold">ttl</text>
  <text x="120" y="286" fill="#8af8c8" text-anchor="middle" font-size="10">1 byte</text>

  <rect x="185" y="244" width="390" height="52" fill="#5a2d3d" stroke="#d94a6a" stroke-width="1.5" rx="3"/>
  <text x="380" y="268" fill="#e0e0e0" text-anchor="middle" font-size="12" font-weight="bold">min_mtu</text>
  <text x="380" y="286" fill="#f88aaa" text-anchor="middle" font-size="10">2 bytes LE</text>

  <!-- Row 5 (44–45): origin_coords_cnt -->
  <text x="50" y="322" fill="#666" font-size="10" text-anchor="end">44–45</text>

  <rect x="55" y="296" width="260" height="52" fill="#4a3d2d" stroke="#d9b04a" stroke-width="1.5" rx="3"/>
  <text x="185" y="326" fill="#e0e0e0" text-anchor="middle" font-size="12" font-weight="bold">origin_coords_cnt</text>

  <!-- Row 6 (46–): origin_coords -->
  <text x="50" y="370" fill="#666" font-size="10" text-anchor="end">46–</text>

  <rect x="55" y="348" width="520" height="40" fill="#1f1f3a" stroke="#4ad9d9" stroke-width="1" stroke-dasharray="4,3" rx="3"/>
  <text x="315" y="372" fill="#8af8f8" text-anchor="middle" font-size="11">origin_coords × n (16 bytes each — NodeAddr only)</text>

  <!-- Row 7: visited bloom -->
  <text x="50" y="414" fill="#666" font-size="10" text-anchor="end">+1+256</text>

  <rect x="55" y="394" width="130" height="40" fill="#3d3d2d" stroke="#a0a04a" stroke-width="1.5" rx="3"/>
  <text x="120" y="418" fill="#d8d88a" text-anchor="middle" font-size="10">hash_cnt</text>

  <rect x="185" y="394" width="390" height="40" fill="#1f1f3a" stroke="#a0a04a" stroke-width="1" stroke-dasharray="4,3" rx="3"/>
  <text x="380" y="418" fill="#d8d88a" text-anchor="middle" font-size="11">visited_bits (256 bytes)</text>

  <!-- Total -->
  <text x="310" y="462" fill="#777" font-size="10" text-anchor="middle">total: 303 + (n × 16) bytes, where n = origin depth + 1</text>
</svg>
